---
layout:     post                    # 使用的布局（不需要改）
title:      Recommendation System               # 标题 
subtitle:   Hello World, Hello Blog #副标题
date:       2019-01-04              # 时间
author:     DF                      # 作者
header-img: img/bg-post.jpg    #这篇文章标题背景图片
catalog: true                       # 是否归档
tags:                               #标签
    - RS
---

### 深度学习在推荐系统中的应用总结 【1】

>In general, recommendation lists are generated based on user preferences, item features, user-item past interactions and some other additional information such as temporal (e.g., sequence-aware recommender) and spatial (e.g., POI recommender) data. 
>**分类**: collaborative filtering (learning from user-item historical interactions explicitly or implicitly)，content-based recommender (based on comparisons across items' and users' auxiliary information like text, images, videos)，hybrid recommender (intergretes more strategies).
>**面临问题**：data sparsity，cold-start problem，balancing the recommendation quality in terms of different evaluation metrics.
>**Deep learning**：可以有效获取非线性和重要的user-item关系，且可以在高层中获得更实用的抽象特征，从富有大量冗余信息的数据中获取复杂的关系，如上下文信息，文本信息，图片信息等。
>**根据输出的形式，推荐分为**rating prediction(fill the miss entries of the user-item rating matrix), ranking prediction, classification.
>**Related deep learning**: MLP, AE (denoising AE, marginalized denoising AE, sparse AE, contractive AE, VAE), CNN, RNN (LSTM, GRU), DSSM, RBM, NADE, GAN
>现有的模型可以按照neural network model vs. integration model来进行归类
>- **Neural network model**：分为使用单一模型（MLP进行用户物品间非线性拟合，CNN提取局部和全局信息，RNN提取序列信息，DSSM进行语义匹配）和使用复合模型（不同模型可以互补）
>- **Integration model**：考虑是否与传统推荐（MF，PMF，FM，NN等）相结合进行分类，且考虑参数是否同时训练分为Loosely和Tightly
>![](https://pic1.zhimg.com/80/v2-b46e204d53c77af2cc863e743aad5d6d_hd.png)
>发展顺序：RBM，DSSM -> AE, RNN, CNN, MLP -> GAN, NADE
>Evaluation metrics: rating prediction (RMSE, MAE); ranking predition (Recall, Precision, NDCG, AUC); classification (Recall, Precision, F1)
>应用领域：图片推荐，音乐推荐，POI推荐，新闻推荐，标签推荐，quote推荐，引用推荐。

### 推荐系统从入门到接着入门【2】
>随着当今技术的飞速发展，数据量也与日俱增，人们越来越感觉在海量数据面前束手无策。正是为了解决**信息过载**(Information overload)的问题，人们提出了**推荐系统**（与搜索引擎对应，人们习惯叫推荐系统为推荐引擎）。当我们提到推荐引擎的时候，经常联想到的技术也便是**搜索引擎**。不必惊讶，因为这两者都是为了解决信息过载而提出的两种不同的技术，一个问题，两个出发点，我更喜欢称它们两者为兄弟，亲近而形象。
>兄弟二人有共同的目标，即解决信息过载问题，但具体的做法因人而异。
>**搜索引擎**更倾向于人们有明确的目的，可以将人们对于信息的寻求转换为精确的关键字，然后交给搜索引擎最后返回给用户一系列列表，用户可以对这些返回结果进行反馈，并且是对于用户有主动意识的，但它会有**马太效应**的问题，即会造成越流行的东西随着搜索过程的迭代会越流行，使得那些越不流行的东西石沉大海。
>而**推荐引擎**更倾向于人们没有明确的目的，或者说他们的目的是模糊的，通俗来讲，用户连自己都不知道他想要什么，这时候正是推荐引擎的用户之地，推荐系统通过用户的历史行为或者用户的兴趣偏好或者用户的人口统计学特征来送给推荐算法，然后推荐系统运用推荐算法来产生用户可能感兴趣的项目列表，同时用户对于搜索引擎是被动的。其中**长尾理论**（人们只关注曝光率高的项目，而忽略曝光率低的项目）可以很好的解释推荐系统的存在，试验表明位于长尾位置的曝光率低的项目产生的利润不低于只销售曝光率高的项目的利润。推荐系统正好可以给所有项目提供曝光的机会，以此来挖掘长尾项目的潜在利润。
>如果说搜索引擎体现着马太效应的话，那么长尾理论则阐述了推荐系统所发挥的价值。
>推荐系统是多个领域的交叉研究方向，所以会涉及机器学习以及数据挖掘方面的技巧。
>![](https://pic1.zhimg.com/80/v2-9b54432029839411fcd397173cc34090_hd.png)
>**RS**(Recommender System)：RecSys
>**IR**  (Information Retrieval): SIGIR
>**DM**(Data Mining): SIGKDD,ICDM, SDM
>**ML**  (Machine Learning): ICML, NIPS
>**CV**  (Computer Vision): ICCV, CVPR, ECCV
>**MM**  (MultiMedia): ACM MM
>**DB**  (Database): CIKM, WIDM  
>**AI**  (Artificial Intelligence): IJCAI, AAAI
>![](https://pic1.zhimg.com/80/v2-51126defb3579f1e09e3dd2347f2a596_hd.png)

### 深度学习CTR模型的演化图谱【3】
![](https://pic1.zhimg.com/80/v2-ba0da131c7852e9b31f942c1b66ab974_hd.png)
>- 模型的在业界影响力较大的；
>- 已经被Google，微软，阿里等知名互联网公司成功应用的；
>- 工程导向的，而不是仅用实验数据验证或学术创新用的

### 深度学习在推荐算法上的应用进展 【4】
> **评分预测**
> 最早的推荐系统任务（也是目前较为常见的任务）是评分预测。输入归纳起来可以分为用户（User）、物品（Item）和打分（Rating）三个方面，因此可以使用一个二维矩阵来刻画评分预测的输入，分别对应于一个矩阵中的行、列、值。为了解决这一问题，常见的算法如基于相似近邻的协同过滤算法、矩阵分解等。其中矩阵分解算法得到了广泛应用，并且在实践中具有很好的实战效果。
> **物品推荐**
> 与评分预测相似，物品推荐任务的输入是以用户（User）及物品（Item）组成的二维矩阵来描述，不同的是每个矩阵数值不是一个具体的打分，而是一个用户是否选择了某一物品。大部分评分预测算法都可以（可能需要进行适当改动）应用到物品推荐中。
> **基于背景或者特征的推荐（Context-aware recommendation）**
> 推荐系统的不断发展，进一步丰富了可供推荐算法使用的信息。如对于新闻推荐，物品的属性则有可能是新闻的文本内容、关键词、时间等，同时包括用户的点击、收藏和浏览行为等。在电商网站上，还可能包含很多信息评论文本（ReviewText）、用户查看的历史记录、用户购买的记录等。还可能获得用户的反馈信息，总体上可以分为两类，一是显式的用户反馈（Explicit Feedback），这是用户对商品或信息给出的显式反馈信息，评分、评论属于该类；另一类是隐式的用户反馈（ImplicitFeedback），这类一般是用户在使用网站的过程中产生的数据，它们也反映了用户对物品的喜好，比如用户查看了某物品的信息、用户在某一页面上的停留时间等。对于背景敏感的推荐任务，可以使用SVD++[2]、 SVDFeature[3]、 libFM[4] 等基于特征的推荐算法。
> **复杂推荐任务**
> 在真实的应用中，往往要面临很多复杂的推荐任务。例如，在基于 session 的推荐任务中，用户在一个时间片段内连续做出相应的操作和选择，需要考虑用户整体的兴趣偏好和在一个特定session 内的连续行为。这种任务的解决方法往往和序列模型相关。另一种复杂任务叫做基于页面的推荐。上述所提到的推荐任务的返回结果都是一个单一列表，而实际上往往需要进行基于用户 UI 方面的结果展示。例如，在一个电商平台，如何将推荐产品合理地展示在页面的各个部分，可能的策略如按照类别分类展示、重点区域突出个性化推荐结果。这种任务目前在研究中还很少被关注，主要原因是很难得到相关的科研数据。

### 关于评分预测和TopN推荐【5】
>推荐系统的两大场景是评分预测（rating prediction）与 Top-N 推荐（Top-N recommendation/item rank/item recommendation）。
>**评分预测**场景主要用于评价网站，比如用户给自己看过的电影评多少分，抽取有用的数据形式为每个元素为1.0-5.0范围的UI矩阵。一般对于评分预测场景我们采用point-wise的方式进行用户偏好建模，即考虑单个用户对于单个物品的偏好程度。评分预测最常用的技术是Matrix Factorization，当然建模方式采用的是矩阵分解技术来最小化平方损失，评价指标为均方根误差（RMSE）和平均绝对误差（MAE）了。一般评分预测场景下需要用户显式的对物品进行喜好的反馈，即我对于这部电影的具体喜欢程度，（打5.0分表示喜欢，打1.0表示不感兴趣），但该场景适用范围不大，因为大部分场景下我们是拿不到用户对物品的打分程度的，只能够拿到用户的隐式反馈信息（即用户浏览了啥项目，用户购买了啥东西或者用户观看了某部电影），因此我们更关注第二类场景，即TopN推荐。
>**Top-N推荐**场景主要用于购物网站或者一般拿不到显式评分信息的网站，即通过用户的隐式反馈信息来给用户推荐一个可能感兴趣的列表以供其参考，抽取出有用的数据形式为每个元素为0或者1的UI矩阵。一般我们的naive的想法是通过采用point-wise的方式来进行用户的偏好建模，然后预测出每个用户对每个项目的评分（或者是0-1之间的一个概率值），然后排序，给用户推荐top-n的项目。固然此方法简单易行，但根据任务的损失函数与评价指标一体联动思维，我们是个排序任务，评价指标主要是MAP和NDCG等，因此还是采用point-wise的方式来建模会有所欠缺。因此对于Top-N推荐我们采用pair-wise的方式来对用户进行偏好的偏序建模，即考虑每个用户对于物品的喜好偏序关系。Top-N推荐最常用的技术是BPR，主要的想法是用户喜欢的物品要排在不喜欢物品的前边，然后采用排序模型来建模，最后用排序指标来评测。

### 知识图谱引入推荐系统
按照预测对象的不同，推荐系统一般可以分成两类：一类是评分预测（rating prediction），例如在电影类应用中，系统需要预测用户对电影的评分，并以此为根据推送其可能喜欢的电影。这种场景下的用户反馈信息表达了用户的喜好程度，因此这种信息也叫显式反馈（explicit feedback）；另一类是点击率预测（click-through rateprediction），例如在新闻类应用中，系统需要预测用户点击某新闻的概率来优化推荐方案。这种场景下的用户反馈信息只能表达用户的行为特征（点击/未点击），而不能反映用户的喜爱程度，因此这种信息也叫隐式反馈（implicit feedback）。
传统的推荐系统只使用用户和物品的历史交互信息（显式或隐式反馈）作为输入，这会带来两个问题：一，在实际场景中，用户和物品的交互信息往往是非常稀疏（sparse）的。例如，一个电影类APP可能包含了上万部电影，然而一个用户打过分的电影可能平均只有几十部。使用如此少量的已观测数据来预测大量的未知信息，会极大地增加算法的过拟合（overfitting）风险；二，对于新加入的用户或者物品，由于系统没有其历史交互信息，因此无法进行准确地建模和推荐，这种情况也叫做冷启动问题（cold start problem）。
解决稀疏性和冷启动问题的一个常见思路是在推荐算法中额外引入一些辅助信息（side information）作为输入。辅助信息可以丰富对用户和物品的描述、增强推荐算法的挖掘能力，从而有效地弥补交互信息的稀疏或缺失。常见的辅助信息包括：
社交网络（social networks）：一个用户对某个物品感兴趣，他的朋友可能也会对该物品感兴趣；
用户/物品属性（attributes）：拥有同种属性的用户可能会对同一类物品感兴趣；
图像/视频/音频/文本等多媒体信息（multimedia）：例如商品图片、电影预告片、音乐、新闻标题等；
上下文（context）：用户-物品交互的时间、地点、当前会话信息等。


### Matrix Factorization Techniques for RS【6】
>**推荐系统**的研究从上世纪90年代初发展至今，目前有三大主流算法: 基于内容的过滤算法（content-based filtering，简称CBF）、邻域算法（neighborhood methods）、隐语义模型（latent factor models，简称LFM），其中后两者统称为协同过滤算法（collaborative filtering，简CF）
>![](https://pic2.zhimg.com/80/v2-ad8580627a86370d3313def2254a82c2_hd.png)
>CBF通过给用户、物品定义显式的属性（通常会找所涉及的推荐领域的人类专家来定义）来描述他们的本质，然后为用户推荐与他们本质“门当户对”的物品；CF则是通过发动“群体的力量”，从其他用户、物品中学习到宝贵的信息，无需显式地定义属性：CF下的邻域算法着重于学习用户与用户、物品与物品之间的关系，为目标用户推荐与目标用户相似的用户所选择的物品（user-based）或者与目标用户所选择的物品相似的物品（item-based）；CF下的隐语义模型则是通过学习用户与用户、物品与物品之间的关系来自动获得用户、物品的隐属性（这里的“隐”指的是学习到的属性是不可解释的），相当于把用户-评分矩阵分解成用户隐属性矩阵和物品隐属性矩阵，然后通过用户隐属性向量u与物品隐属性向量i作点乘来获取到该用户对该物品的评分，以此为依据进行推荐。下面的表格列出了三种主流方法优缺点：
>![](https://pic4.zhimg.com/80/v2-69826038cb83e181c7e97c2c3d65a388_hd.png)
>**矩阵分解(Matrix Factorization)的主要思想** 
>通过把整理、提取好的“用户—物品”评分矩阵进行分解，来得到一个用户隐向量矩阵和一个物品隐向量矩阵。假设现在有一个M * N的矩阵，M代表用户数，N代表物品数，想将用户、物品分别训练出两个隐属性，即每个用户、每个物品都对应着一个二维向量，即得到了一个M * 2的用户隐向量矩阵和一个N * 2 的矩阵，分解示意图如下所示： （得到了用户的偏好，以及物品的特性 2. 降低了矩阵的维度）
>![](https://pic4.zhimg.com/80/v2-ffc3aa5c58832fb465ac77160a09f6f3_hd.png)
>在得到用户隐向量和物品隐向量（均是2维向量）之后，我们可以将每个用户、物品对应的二维隐向量看作是一个坐标，将其画在坐标轴上。虽然我们得到的是不可解释的隐向量，但是可以为其赋予一定的意义来帮助我们理解这个分解结果。比如我们把用户、物品的2维的隐向量赋予严肃文学（Serious）vs.消遣文学（Escapist）、针对男性（Geared towards males）vs.针对女性（Geared towards females），那么可以形成论文中那样的可视化图片：
>![](https://pic1.zhimg.com/80/v2-5a7c9022194b0210ab46e0bda17e082f_hd.png)
>从上图我们可以看到，用户对于与其处于同一象限的物品的喜爱度/评分是会很高的，因为他们相比于其它的组合更加“门当户对”一些。而实例人物Dave对应的坐标恰好处于坐标系的中央，这说明他对图中所有物品的喜爱程度差不多，没有特别喜欢的也没有特别讨厌的。

### 神经协同过滤 【11】
![](https://pic1.zhimg.com/80/v2-8be045a03bb8f0856ddbbcf7da5af4f7_hd.png)
MF能够表达为NCF 的推广（MF矩阵分解模型是NCF的一个特例）


### 因子机(Factorization Machine) 深入解析 【7，8】
>FM的主要目标是：解决数据稀疏的情况下，特征怎么组合的问题。
>FM算法是一个特征组合以及降维的工具，它能够将原本因为one-hot编码产生的稀疏特征，进行两两组合后还能做一个降维！降到多少维呢？就是FM中隐因子的个数k。
>- 基于矩阵分解的协同过滤是推荐系统中常用的一种推荐方案，从历史数据中收集user对item的评分，可以是显式的打分，也可以是用户的隐式反馈计算的得分。由于user和item数量非常多，有过打分的user和item对通常是十分稀少的，基于矩阵分解的协同过滤是来预测那些没有过行为的user对item的打分，实际上是一个评分预测问题。
>FM的二阶矩阵也用了矩阵分解的技巧，那么基于矩阵分解的协同过滤和FM是什么关系呢？以user对item评分预测问题为例，基于矩阵分解的协同过滤可以看做FM的一个特殊例子，对于每一个样本，FM可以看做特征只有userid和itemid的onehot编码后的向量连接而成的向量。从FM和MFCF公式来看，MFCF的用户向量pu和item向量qi可以看做FM中的隐向量，用户和item的bias向量bu,bi就是FM中的一次项系数，常数μ也和FM中的常数w0相对应，可以看到，MFCF就是FM的一个特例！另外，FM可以采用更多的特征，学习更多的组合模式，这是单个矩阵分解的模型所做不到的！因此，FM比矩阵分解的方法更具普遍性！事实上，现在能用矩阵分解的方法做的方案都直接上FM了！
>![](https://pic4.zhimg.com/80/v2-b00e8c81057968613fcb9afa2a274f86_hd.png)


### DeepFM【9】
>![](https://pic2.zhimg.com/80/v2-2340414b1ac35c1ffbf876ef73369f31_hd.png)
>借助FNN的思想，利用FM进行embedding，之后的wide和deep模型共享embedding之后的结果。DNN的输入完全和FNN相同（这里不用预训练，直接把embedding层看作一层的NN），而通过一定方式组合后，模型在wide上完全模拟出了FM的效果，最后将DNN和FM的结果组合后激活输出。

### Neural Factorization Machines for Sparse Predictive Analytics【10】
![](https://pic1.zhimg.com/80/v2-584ae878a21188969eb5609986da782d_hd.png)
NFM针对FM的缺点，在二阶特征组合的隐向量空间中，引入了非线性变换来提升模型非线性表达能力；同时，也可以学习到高阶的组合特征。
NFM丢弃了直接把embedding vector拼接输入到神经网络的做法，而是采用在embedding层后增加了Bi-Interaction操作来对二阶组合特征进行建模。这使得low level的输入表达的信息更加的丰富，极大的提高了后面隐藏层学习高阶非线性组合特征的能力。




### Reference
> 【1】深度学习在推荐系统中的应用总结 https://zhuanlan.zhihu.com/p/38420154
> *Deep Learning based Recommender System: A Survey and New Perspectives*
> 【2】 推荐系统从入门到接着入门 https://zhuanlan.zhihu.com/p/27502172
> 【3】深度学习CTR模型的演化图谱 https://www.zhihu.com/question/20830906/answer/681688041
> 【4】深度学习在推荐算法上的应用进展 https://zhuanlan.zhihu.com/p/26237106
> 【5】关于评分预测和TopN推荐的讨论 https://www.zhihu.com/question/20391355/answer/338408082
> 【6】Matrix Factorization Techniques for RS https://zhuanlan.zhihu.com/p/28577447
> *Martix Factorization Techniques for Recommendation System*
> 【7】因子机深入解析 https://tracholar.github.io/machine-learning/2017/03/10/factorization-machine.html#%E7%BB%BC%E8%BF%B0
> 【8】Factorization Machines 学习笔记 https://blog.csdn.net/itplus/article/details/40534885
> 【9】# *DeepFM A Factorization-Machine based Neural Network for CTR Prediction* https://blog.csdn.net/zynash2/article/details/79348540
> 【10】# *Neural Factorization Machines for Sparse Predictive Analytics* https://zhuanlan.zhihu.com/p/38613747
> 【11】*Neural Collaborative Filtering* https://www.cnblogs.com/HolyShine/p/6728999.html

### 总结
![](https://pic2.zhimg.com/80/v2-f034c046a84b6f991e44fa4e03cc6e55_hd.png)
### 其他
>The recommender system can actively offer personalized suggestions for users by analyzing the users’ preferences and the item’s attributes. The neural network (NN) model translates the recommendation problem into a regression or classification problem.

>Among them, CF has been widely used, and it includes neighborhood-based CF and model-based CF. matrix factorization (MF), as a representative of model-based CF, represents users and items by automatically extracting latent factors.

> 推荐系统通过分析用户的行为，找到用户的个性化需求，从而将一些长尾的项目个性化推荐给相应的用户，帮助用户找到自己想要但难以被发现的项目。